#packages
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from importlib import reload
data = pd.read_excel('/Users/Owner/OneDrive/Desktop/PGA_Final.xlsx')
del data['Unnamed: 0']
data

#avg distance
distance=data['DISTANCE']
distance_array = np.array(distance)
plt.figure(figsize = (50,5))
plt.hist(distance_array, bins=5)
plt.xlabel('Distance in yds')
plt.ylabel('Number of Drives')
plt.title('Longest Drive')

#number of rows in each year
years = data.groupby('YEAR')['YEAR'].count()
years

#average driving distance by each player in past 10 years (Tiger Woods Example)
a=[]
for i in data['PLAYER NAME']:
    a.append(i)
a=pd.unique(a)

b=[]

for x in a:
    players=data[data['PLAYER NAME']== x]
    player_dist=players['DISTANCE'].mean()
    b.append(player_dist)
b

player_avg_distance = dict(zip(a,b))
player_avg_distance['Tiger Woods']

#average rounds played by each player in past 10 years (Tiger Woods Example)

c=[]
for i in data['PLAYER NAME']:
    c.append(i)
c=pd.unique(c)

d=[]

for x in a:
    players=data[data['PLAYER NAME']== x]
    player_dist=players['ROUNDS'].mean()
    d.append(player_dist)


players_rounds = dict(zip(c,d))
players_rounds['Tiger Woods']

#main stats
df_numerical = data._get_numeric_data()
df_numerical.describe()

#average distance by each tournament

e=[]
for i in data['TOURNAMENT']:
    e.append(i)
e=pd.unique(e)

f=[]

for x in e:
    players=data[data['TOURNAMENT']== x]
    player_dist=round(players['DISTANCE'].mean(),2)
    f.append(player_dist)


tournament = dict(zip(e,f))
tournament['Phoenix Open']

#min and max drive for a player
a=[]
for i in data['PLAYER NAME']:
    a.append(i)
a=pd.unique(a)

b=[]
bb=[]

for x in a:
    players=data[data['PLAYER NAME']== x]
    player_dist_max=players['DISTANCE'].max()
    player_dist_min=players['DISTANCE'].min()
    b.append(player_dist_min)
    bb.append(player_dist_max)


dist_min = dict(zip(a,b))
dist_max = dict(zip(a,bb))
dist_min['Tiger Woods'] 

#tiger woods driving distance past 10 years
tw=data[data['PLAYER NAME']=='Tiger Woods']
x= tw.groupby('YEAR')['DISTANCE'].mean()
y=np.unique(tw['YEAR'])
plt.bar(y,x)

#min, max and avg drive for a player
output=[]
test = ['min','max','avg']
name=input('Player Name')
output.append(dist_min[name])
output.append(dist_max[name])
output.append(round(player_avg_distance[name],2))

print(dict(zip(test,output)))


#what is the longest drive at a given tournament
tourn=[]
print(np.unique(data['TOURNAMENT']))
t=input('Tournament Name')
tourn.append(tournament[t])
print(tourn)

#input a player name and return longest drive over past 10 years
playername= input('Player Name')
abc=data[data['PLAYER NAME']==playername]
xxx= abc.groupby('YEAR')['DISTANCE'].mean()
yyy=np.unique(abc['YEAR'])
plt.bar(yyy,xxx)
