#package imports
from bs4 import BeautifulSoup 
import lxml
import requests as request
import pandas as pd

#access the url and assign
url = 'https://www.pgatour.com/content/pgatour/stats/stat.159.y2022.html'
request.get(url)
page = request.get(url)

#use bs4 
soup = BeautifulSoup(page.text, 'html')

#find the table
table_data = soup.find('table', class_ ='table-styled')

#assign the headers
headers = []
for i in table_data.find_all('th'): #find the positions of the headers
    title = i.text #convert to text
    headers.append(title)

df = pd.DataFrame(columns = headers)
df

#grab the contents of the table
for j in table_data.find_all('tr')[1:]:
        row_data = j.find_all('td')
        row = [tr.text for tr in row_data]
        length = len(df)
        df.loc[length] = row

#print        
df

#data cleaning
name_clean = df['PLAYER NAME'].str.replace('\n', '')
distance = df['DISTANCE']

#analysis

#average Longest drive on tour
avg_distance= pd.to_numeric(distance).mean()

avg_distance
